---** Connect to the server **---
ssh -i <pem.key> ubuntu@<public IP of host>

---** Update the system **---
$ sudo apt-get update && sudo apt-get dist-upgrade -y

---** Upload .pem key to DC **---
scp -i <pem.key> <pem.key> ubuntu@<Public IP>:~/.ssh

---** Create a Hadoop user or group for accessing HDFS
$ sudo addgroup hadoop
$ sudo adduser hduser --ingroup hadoop
$ sudo adduser hduser sudo
$ sudo su haduser   

#Configure SSH
ssh-keygen
cd .ssh
cat id_rsa.pub >> authorized_keys
ssh localhost

#Copy the Public key and sent to the hduser' s directory
$ sudo su
 cp /home/ubuntu/.ssh/<pem.key> /home/hduser/.ssh/
 chown hduser:hadoop /home/hduser/.ssh/<pem.key>
exit

---** Install Java packages **---
$ sudo apt-get install openjdk-8-jdk openjdk-8-jre -y
$ java --version

#Disable IPV6  --- As hadoop 2 does'nt support ipv6
sudo nano /etc/sysctl.conf
net.ipv6.conf.all.disable_ipv6 = 1
net.ipv6.conf.default.disable_ipv6 = 1
net.ipv6.conf.lo.disable_ipv6 = 1
sudo sysctl -p


#Download Hadoop
wget https://dlcdn.apache.org/hadoop/common/stable/hadoop-3.3.6.tar.gz

#Extract and Install Hadoop tar ball
tar -xzvf hadoop-3.3.6.tar.gz
sudo mv hadoop-3.3.6 /usr/local/hadoop
sudo chown hduser:hadoop -R /usr/local/hadoop

# Set Enviornment Variableexport JAVA_HOME=/usr/lib/jvm/java-8-openjdk-amd64
export HADOOP_HOME=/usr/local/hadoop
export PATH=$PATH:$HADOOP_HOME/bin
export PATH=$PATH:$HADOOP_HOME/sbin
export PATH=$PATH:/usr/local/hadoop/bin/
export HADOOP_MAPRED_HOME=$HADOOP_HOME
export HADOOP_COMMON_HOME=$HADOOP_HOME
export HADOOP_HDFS_HOME=$HADOOP_HOME
export YARN_HOME=$HADOOP_HOME
export HADOOP_CONF_DIR=/usr/local/hadoop/etc/hadoop
export PDSH_RCMD_TYPE=ssh

$ source ~/.bashrc

$ cd /usr/local/hadoop/etc/hadoop/

readlink -f $(which java)
$ nano ~/.bashrc

#Update hadoop-env.sh
$ nano hadoop-env.sh
export JAVA_HOME=/usr/lib/jvm/java-8-openjdk-amd64
export HADOOP_LOG_DIR=/var/log/hadoop
$ sudo mkdir /var/log/hadoop
$ sudo chown hduser:hadoop -R /var/log/hadoop

#Disable FireWall iptables
$ sudo iptables -L -n
$ sudo ufw status
$ sudo ufw disable

#Disabling Transparent Hugepage Compaction

$ cat /sys/kernel/mm/transparent-hugepages/defrag

$ sudo nano /etc/init.d/disable-transparent-hugepages

#!/bin/sh
### BEGIN INIT INFO
# Provides:          disable-transparent-hugepages
# Required-Start:    $local_fs
# Required-Stop:
# Default-Start:     2 3 4 5
# Default-Stop:      0 1 6
# Short-Description: Disable Linux transparent huge pages
# Description:       Disable Linux transparent huge pages, to improve
#                    database performance.
### END INIT INFO

case $1 in
  start)
    if [ -d /sys/kernel/mm/transparent_hugepage ]; then
      thp_path=/sys/kernel/mm/transparent_hugepage
    elif [ -d /sys/kernel/mm/redhat_transparent_hugepage ]; then
      thp_path=/sys/kernel/mm/redhat_transparent_hugepage
    else
      return 0
    fi

    echo 'never' > ${thp_path}/enabled
    echo 'never' > ${thp_path}/defrag

    unset thp_path
    ;;
esac

$ sudo chmod 755 /etc/init.d/disable-transparent-hugepages

$ sudo update-rc.d disable-transparent-hugepages defaults

>>Restart server

# Set Swappiness
$ sudo sysctl -a | grep vm.swappiness
$ sudo sysctl vm.swappiness=1

# Configure NTP 
$ timedatectl status
$ timedatectl list-timezones
$ sudo timedatectl set-timezone Asia/Kolkata
$ sudo apt install ntp -y 


  
